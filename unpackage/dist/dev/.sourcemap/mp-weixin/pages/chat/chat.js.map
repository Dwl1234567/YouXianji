{"version":3,"sources":["uni-app:///main.js","webpack:////Users/0821a/Desktop/project001/app/pages/chat/chat.vue?fed3","webpack:////Users/0821a/Desktop/project001/app/pages/chat/chat.vue?c788","webpack:////Users/0821a/Desktop/project001/app/pages/chat/chat.vue?86e7","webpack:////Users/0821a/Desktop/project001/app/pages/chat/chat.vue?560e","uni-app:///pages/chat/chat.vue","webpack:////Users/0821a/Desktop/project001/app/pages/chat/chat.vue?b724","webpack:////Users/0821a/Desktop/project001/app/pages/chat/chat.vue?f8c2"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","jyfParser","barTitle","data","leaveMessage","name","contact","message","attachBackground","showSendButton","showTool","showLeaveMessage","expressionData","config","tokenList","kefuMessage","wrapperHeight","ws","SocketTask","Timer","ErrorMsg","MaxRetryCount","CurrentRetryCount","socketOpen","pageHideCloseWs","unloadCloseWs","csr","sessionId","sessionUser","kefuMessageFocus","messageList","chatRecordPage","errorTips","selectModel","selectModelData","writeBottom","kefu_scroll_top","kefu_scroll_with_animation","record_scroll_height","navigation_bar_title","onLoad","token","fixedCsr","onShow","onHide","console","uni","onUnload","methods","load","kefu_tourists_token","url","fixed_csr","success","kefu_notice","res","that","innerAudioContext","expression","content","showCancel","delta","fail","title","switch_show_tool","set_navigation_bar_title","close_notice","select_done","show_select_model","data_api_url","complete","parseUrl","message_img_preview","preview_img","current","urls","upload_file","c","a","formData","filePath","uploadTask","connect_socket","header","clearInterval","action","retry_websocket","ws_send","send_message","icon","message_type","session_id","modulename","message_id","id","status","sender","datetime","find_emoji","build_chat_img","leave_message","post_leave_message","domsg","default","initialize","user_initialize","show_msg","clear","offline","online","csr_change_status","transfer_done","new_message","msg","record_id","chat_record","setTimeout","kefu_scroll","scrollOffset","read_message_done","message_input","upload_multipart","get_csr_status","build_url","protocol","upload","storage_notify","message_prompt","new_message_prompt","scroll_into_footer","wrapper_scrolltoupper","page","tap_scroll_view","show_tool","textarea_focus","textarea_input","session_user","type","kefu_message_change","write","size","kefu_message_blur","select_expression","format_message","message_obj"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,aAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;AACa;;;AAGhE;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,2PAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACxDA;AAAA;AAAA;AAAA;AAAk0B,CAAgB,kyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACmKt1B;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AAAA,gBACA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QACAC;QACAC;QAAA;QACAC;MACA;;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IAEA;IACA;IACAC;IACAC;;IAEA;EAIA;EACAC;IACA;MACA;IACA;IAEA;EAEA;EACAC;IAEA;MACAC;MACAC;IACA;EAEA;EACAC;IACA;MACAF;MACA;MACAC;IACA;EACA;EACAE;IACAC;MACA;MACA;;MAEA;MACA;QACA;QACA;UACAC;QACA;MACA;QACAL;MACA;MAEAC;QACAK;QACAhD;UACAsC;UACAS;UACAE;QACA;QACAC;UACA;YAEA;YACA;cACA;gBACAP;cACA;gBACAD;cACA;YACA;;YAEA;YACA;YACA;cACAS;YACA;cACAT;YACA;YACA;cACAU;YACA;;YAEA;YACAC;YACAA;;YAEA;YACAC;YACAA;;YAEA;YACA;cACAD;YACA;;YAEA;YACA;YACA;YACA;cACAE;gBACA;gBACA;cACA;YACA;YACAF;;YAEA;YACAA;;YAEA;YACAA;UACA;YACAV;cACAa;cACAC;cACAP;gBACA;kBACAP;oBACAe;kBACA;gBACA;cACA;YACA;UACA;QACA;QACAC;UACAhB;YACAiB;YACAJ;YACAC;UACA;UACAJ;QACA;MACA;IACA;IACAQ;MACA;QACA;QACA;MACA;QACA;QACA;QACA;MACA;IACA;IACAC;MAAA;MACA;QACA;MACA;MACAnB;QACAiB;MACA;IACA;IACAG;MACApB;MACA;IACA;IACAqB;MACA;MACA;MACA;QACA5D;MACA;MACA;MACA;MACA;IACA;IACA6D;MAAA;MACA;MACA;QACA;MACA;MAEAtB;QACAiB;MACA;MAEA;MACA;MACA;QACAM;MACA;MAEA;MAEAvB;QACAK;QACAhD;UACAsC;QACA;QACAY;UACA;YACA;UACA;YACAP;cACAiB;cACAJ;cACAC;YACA;UACA;QACA;QACAE;UACAhB;YACAiB;YACAJ;YACAC;UACA;QACA;QACAU;UACAxB;QACA;MACA;IACA;IACAyB;MACA;MACA;IACA;IACAC;MACA;IACA;;IACAC;MACA;MACA3B;QACA4B;QACAC;MACA;IACA;IACAC;MACA;MACApB;;MAEAA;QACAqB;QACAC;MACA;MAEAhC;QACAO;UACA;UAEAP;YACAiB;UACA;UAEA;UACA;YACA;cACAgB;YACA;UACA;UAEA;YACA5B;YAIA6B;YACA3E;YACA0E;YACA1B;cACAP;cACAU;cACAD;cACA;gBACAC;gBACAA;gBACAA;cACA;gBACAV;kBACAiB;kBACAJ;kBACAC;gBACA;cACA;YACA;YACAU;cACAxB;YACA;UACA;UAGAmC;YACAnC;cACAiB;YACA;UACA;QAEA;MACA;IACA;IACAmB;MACA;MAEA;QACArC;QACA;MACA;;MAEA;MACAW;QACAL;QACAgC;UACA;QACA;QACAb;MACA;;MAEA;MACAxB;QACAD;QACAW;QACAA;QACA;QACA;UACAA;QACA;QACAA;QACAA;QAEA;UACA4B;QACA;QAEA5B;MACA;;MAEA;MACAV;QACA;QACA;QACA;QACAuC;MACA;;MAEA;MACAvC;QACAU;QACAA;QACAX;MACA;;MAEA;MACAC;QACA;QACAD;QACAW;QAEA;UACA4B;QACA;QAEA;UACA5B;QACA;QAEA;UACA;QACA;QAEA;UACAA;QACA;MACA;IACA;;IACA;IACA8B;MACA;MACA;QACA9B;QACAA;QACAA;MACA;QACA;UACA4B;QACA;QAEA5B;QACAA;MACA;IACA;;IACA;IACA+B;MACA;MACA;QACAhF;UACAsE;UACAC;QACA;MACA;MAEA;QACAhC;UACA3C;QACA;MACA;QACA0C;QACAW;MACA;IACA;IACAgC;MACA;MAEA3C;MACA;QACAC;UACAiB;UACA0B;QACA;QACA;MACA;MACA;MACA;QACA3C;UACAiB;UACA0B;QACA;QACA;MACA;MAEA;QACA3C;UACAiB;UACA0B;QACA;QACA;MACA;MAEA;QAEA;QACAlF;;QAEA;QACA;QACA;QAEA;UAEA;YACA;YACAA;UACA;QACA;MAEA;MAEA;MACA;MACA;MACA;QACAsE;QACAC;QACA3E;UACAI;UACAmF;UACAC;UACAC;UACAC;QACA;MACA;MAEArC;MAEA;QACAsC;QACAC;QAAA;QACAC;QACAzF;QACAmF;MACA;MAEA;MACA;QACAlC,8GACArD,KACA;MACA;QACAqD;UACAyC;UACA9F;QACA;MACA;MAEAqD;MACAA;MACAA;IACA;IACA0C;MACA;QACA;UACA;QACA;MACA;MAEA;IACA;IACAC;MAAA;MACA;MACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;QACA;MACA;QACA;MACA;QACA;MACA;IACA;IACAC;MACA;QACAvD;UACAiB;UACA0B;QACA;QACA;MACA;MAEA;QACAZ;QACAC;QACA3E;MACA;MACA;IACA;IACAmG;MAAA;MACA;MACA;QACAC;UACA;QAAA,CACA;QACAC;UACA;YACAhD;UACA;;UAEA;UACA;YACAqB;YACAC;YACA3E;cACAiD;YACA;UACA;UACAI;QACA;QACAiD;UACA;UACA;YAEA;cACAjD;gBACAV;kBACAiB;kBACA0B;gBACA;cACA;YACA;YAEAjC;YACAA;YACAA;YACAA;UACA;YAEA;cAEA;cACAA;cACAA;cACAA;YACA;cACAV;gBACAiB;gBACA0B;cACA;YACA;UAEA;QACA;QACAiB;UACA5D;YACAiB;YACA0B;UACA;QACA;QACAW;UACAtD;YACAiB;YACA0B;UACA;UACAjC;YACAnD;YACAC;YACAC;UACA;QACA;QACAoG;UACA;YACA7D;cACAiB;cACA0B;YACA;UACA;UAEA;YACAZ;YACAC;UACA;UACAtB;UAEAA;QACA;QACAoD;UACA;YACA;UACA;QACA;QACAC;UACA;UACA;YAEA;cACArD;YACA;cACA;cACA;gBACAqB;gBACAC;cACA;cACAtB;YACA;UACA;QACA;QACAsD;UACA;YACA;cACAtD;YACA;cACAA;YACA;UACA;QACA;QACAuD;UACAvD;UACAA;QACA;QACAwD;UACAxD;UAEA;YAEAA;YAEA;YACAyD;YACA;cACAzD,6GACA,CACAyD,SACA;YACA;cACAzD;gBACAyC;gBACA9F;cACA;YACA;YAEA;cACA0E;cACAC;cACA3E;gBACA+G;gBACAvB;cACA;YACA;YAEAnC;YAEAA;UACA;QACA;QACA2D;UACA;UACA3D;UACA;YACAyD;UACA;UACA;YACAzD;YACA;YACAA;UACA;YACA;cACAyD;cACAzD;YACA;YAEA4D;cACA;cACAC;gBACAC;cACA;gBACA9D;gBACAA;cACA;YACA;UACA;QACA;QACAgC;UACA;YACA;UACA;UAEA;UACA;YACA;cACAhC;cACAA;YACA;UACA;UAEA;YACAV;cACAiB;cACA0B;YACA;UACA;QACA;QACA8B;UACA;YACA;cACA;gBACA;kBACA/D;gBACA;cACA;YACA;cACA;gBACA;kBACA;oBACAA;kBACA;gBACA;cACA;YACA;UACA;QACA;QACAgE;UACA;UACA;UACA;YACA;UACA;UAEA;YACAhE;UACA;YACAA;UACA;QACA;QACAiE;UACA;YACAjE;UACA;QACA;MACA;IACA;IACAkE;MAEA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;MAEA;IACA;IACAC;MAAA;MAAA;MACA;MACA;MACA;MACA,8HACA;MAEA;QACA1G;UACA2G;UACA,+GACA1E,6BACA;QACA;QACAsD;UACA;QACA;QACAqB;UACA;QACA;QACAC;UACA;UACA;QACA;QACAC;UACA;YACA;UACA;UACA;QACA;QACAxE;UACA;YACA;UACA;UACA;QACA;QACAgD;UACA;QACA;MACA;MAEA;MACA;IACA;IACAyB;MACA;QACAvE;QACA2D;UACA3D;QACA;MACA;QACAZ;MACA;IACA;IACAoF;MAAA;MAAA;MACA;MACA;QACAb;UACA5D;QACA;QACA;MACA;MACA;MACA6D;QACAC;MACA;QACAF;UACA5D;QACA;MACA;IACA;IACA0E;MACA;MACA;QACA;MACA;;MAEA;MACA;QACArD;QACAC;QACA3E;UACAwF;UACAwC;QACA;MACA;MAEA3E;MACA;MACA6D;QACAC;MACA;QACA9D;MACA;MAEA;IACA;IACA4E;MACA;IACA;IACAC;MAAA;MAEA;MAEA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA9E;MACAA;IACA;IACA;IACA+E;MACA;MACA/E;MACAA;MAEA;QACA;MACA;MAEA;QACAqB;QACAC;QACA3E;UACAwF;UACA6C;UACAC;QACA;MACA;MACAjF;IACA;IACA;IACAkF;MAAA;MACA;MACA;MACAC;QACAC;MACA;QACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACArF;MACA;QACAA;MACA;MAEA;QACA;MACA;MAEA;QACAqB;QACAC;QACA3E;UACAwF;UACA6C;UACAC;QACA;MACA;MACAjF;IACA;IACAsF;MACA;MACA;IACA;IACAC;MACA;QACA;UACA;UACA;UAEA;YACA;YACA;cACAC;YACA;UACA;UACAzI;QACA;MACA;MACA;IACA;EACA;AACA;AAAA,4B;;;;;;;;;;;;;AC1qCA;AAAA;AAAA;AAAA;AAA+qC,CAAgB,+lCAAG,EAAC,C;;;;;;;;;;;ACAnsC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/chat/chat.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/chat/chat.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat.vue?vue&type=template&id=bf16e7f4&\"\nvar renderjs\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/chat/chat.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=template&id=bf16e7f4&\"","var components\ntry {\n  components = {\n    jyfParser: function () {\n      return import(\n        /* webpackChunkName: \"components/jyf-parser/jyf-parser\" */ \"@/components/jyf-parser/jyf-parser.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.selectModel ? _vm.selectModelData.length : null\n  var l0 =\n    _vm.selectModel && g0 > 0\n      ? _vm.__map(_vm.selectModelData, function (item, index) {\n          var $orig = _vm.__get_orig(item)\n          var g1 = index.toString()\n          return {\n            $orig: $orig,\n            g1: g1,\n          }\n        })\n      : null\n  var g2 = _vm.selectModel ? _vm.selectModelData.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        l0: l0,\n        g2: g2,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n\t\t<!--标题栏-->\n\t\t<bar-title bgColor=\"bg-white\" isBack>\n\t\t\t<block slot=\"content\">\n\t\t\t\t<!--\n\t\t\t\t客服名称\n\t\t\t\t<text class=\"margin-right-xs\"></text>\n\t\t\t\t<text class=\"cu-tag bg-blue sm radius\">\n\t\t\t\t\t<text class=\"cuIcon-male\"/>\n\t\t\t\t</text>\n\t\t\t\t-->\n\t\t\t</block>\n\t\t\t<!--<block slot=\"right\">\n\t\t\t\t<text class=\"cuIcon-more\"/>\n\t\t\t</block>-->\n\t\t</bar-title>\n\t\t<view class=\"kefu_container\">\n\t\t\t<view v-if=\"errorTips\" class=\"error_tips\">{{errorTips}}</view>\n\t\t\t<view v-if=\"config.announcement && errorTips == ''\" class=\"notice\">{{config.announcement}}<text @tap=\"close_notice\"\n\t\t\t\t class=\"close_notice\">不再显示</text></view>\n\n\t\t\t<!--留言板-->\n\t\t\t<view v-if=\"showLeaveMessage\" class=\"leave_message\">\n\t\t\t\t<form method=\"get\" action=\"\">\n\t\t\t\t\t<view class=\"form-group\">\n\t\t\t\t\t\t<label for=\"c-name\" class=\"control-label\">姓名</label>\n\t\t\t\t\t\t<input type=\"text\" @input=\"leave_message\" name=\"name\" :value=\"leaveMessage.name\" class=\"form-control\" id=\"c-name\"\n\t\t\t\t\t\t placeholder=\"请输入您的姓名\">\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"form-group\">\n\t\t\t\t\t\t<label for=\"c-contact\" class=\"control-label\">联系方式</label>\n\t\t\t\t\t\t<input type=\"text\" @input=\"leave_message\" name=\"contact\" :value=\"leaveMessage.contact\" class=\"form-control\" id=\"c-contact\"\n\t\t\t\t\t\t placeholder=\"请输入手机/QQ/微信号\">\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"form-group\">\n\t\t\t\t\t\t<label for=\"c-message\" class=\"control-label\">留言内容</label>\n\t\t\t\t\t\t<textarea rows=\"5\" @input=\"leave_message\" name=\"message\" :value=\"leaveMessage.message\" class=\"form-control\" id=\"c-message\"\n\t\t\t\t\t\t placeholder=\"遇到的问题、所需服务、产品等，我们将尽快与您取得联系\"></textarea>\n\t\t\t\t\t</view>\n\t\t\t\t\t<button @tap=\"post_leave_message\" type=\"button\" class=\"leave_success\">确认留言</button>\n\t\t\t\t</form>\n\t\t\t</view>\n\t\t\t<!-- 留言板end -->\n\n\t\t\t<!-- 主界面 -->\n\t\t\t<!-- #ifdef H5 -->\n\t\t\t<view class=\"content_wrapper\" v-if=\"!showLeaveMessage\" :style=\"{height:'calc(100vh - var(--window-top) - ' + writeBottom + 'px)'}\">\n\t\t\t\t<!-- #endif -->\n\t\t\t\t<!-- #ifndef H5 -->\n\t\t\t\t<view class=\"content_wrapper\" v-if=\"!showLeaveMessage\" :style=\"{height:'calc(100vh - ' + writeBottom + 'px)'}\">\n\t\t\t\t\t<!-- #endif -->\n\n\t\t\t\t\t<view :style=\"{height:'calc(100% - ' + wrapperHeight + 'px)'}\" class=\"chat_wrapper\">\n\t\t\t\t\t\t<scroll-view @scrolltoupper=\"wrapper_scrolltoupper\" id=\"kefu_scroll\" @tap=\"tap_scroll_view\" :scroll-y=\"true\"\n\t\t\t\t\t\t :scroll-with-animation=\"kefu_scroll_with_animation\" :scroll-top=\"kefu_scroll_top\">\n\n\t\t\t\t\t\t\t<block v-for=\"(item, index) in messageList\" :key=\"index\">\n\t\t\t\t\t\t\t\t<view class=\"status\"><text>{{item.datetime}}</text></view>\n\t\t\t\t\t\t\t\t<block v-for=\"message in item.data\" :key=\"message.id\">\n\n\t\t\t\t\t\t\t\t\t<view v-if=\"message.message_type == 3\" class=\"status\"><text>{{message.message}}</text></view>\n\n\t\t\t\t\t\t\t\t\t<view v-if=\"message.message_type != 3\" class=\"bubble\" :class=\"message.sender == 'me' ? 'me':'you'\">\n\n\t\t\t\t\t\t\t\t\t\t<!-- 除了商品/订单卡片和图片，其他的都使用富文本 -->\n\t\t\t\t\t\t\t\t\t\t<jyf-parser @imgtap=\"message_img_preview\" :tag-style=\"{img:'width:60px;height:60px;'}\" v-if=\"message.message_type == 0\"\n\t\t\t\t\t\t\t\t\t\t :html=\"message.message\"></jyf-parser>\n\n\t\t\t\t\t\t\t\t\t\t<jyf-parser v-if=\"message.message_type == 2\" :html=\"'<a target=_blank href=' + message.message + '>' + message.message + '</a>'\"></jyf-parser>\n\n\t\t\t\t\t\t\t\t\t\t<image @tap=\"preview_img(message.message)\" v-if=\"message.message_type == 1\" :src=\"message.message\" mode=\"widthFix\"></image>\n\n\t\t\t\t\t\t\t\t\t\t<view v-if=\"message.message_type == 4 || message.message_type == 5\" class=\"project_item\">\n\t\t\t\t\t\t\t\t\t\t\t<image :src=\"message.message.logo\"></image>\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"project_item_body\">\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"project_item_title\">{{message.message.subject}}</view>\n\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"message.message.note\" class=\"project_item_note\">{{message.message.note}}</view>\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"project_item_price\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text v-if=\"message.message.price\">￥{{message.message.price}}</text>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text v-if=\"message.message.number\">x{{message.message.number}}</text>\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t</view>\n\n\t\t\t\t\t\t\t\t\t\t<view v-if=\"message.sender == 'me' && message.status <= 1\" class=\"kefu_message_status\" :class=\"(message.status == 0 ? '':' kf-text-grey')\">{{message.status == 0 ? '未读':'已读'}}</view>\n\t\t\t\t\t\t\t\t\t\t<view v-if=\"message.sender == 'me' && message.status == 3\" class=\"kefu_message_status kf-text-red\">失败</view>\n\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t</block>\n\n\t\t\t\t\t\t</scroll-view>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<!-- 消息输入 -->\n\t\t\t\t\t<view class=\"write\" :style=\"{bottom: writeBottom + 'px'}\">\n\t\t\t\t\t\t<view class=\"widget_textarea\">\n\t\t\t\t\t\t\t<textarea :adjust-position=\"false\" :show-confirm-bar=\"false\" :fixed=\"true\" :focus=\"kefuMessageFocus\"\n\t\t\t\t\t\t\t :auto-height=\"true\" maxlength=\"-1\" @blur=\"kefu_message_blur\" @input=\"textarea_input\" :cursor-spacing=\"14\"\n\t\t\t\t\t\t\t @focus=\"textarea_focus\" :value=\"kefuMessage\" class=\"kefu_message\"></textarea>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"write_right\" :style=\"{flex:showSendButton ? 3:2}\">\n\t\t\t\t\t\t\t<i v-if=\"config.toolbar && config.toolbar.expression\" :style=\"{background: 'url(' + config.toolbar.expression.icon_image + ') no-repeat','background-size':'100% 100%'}\"\n\t\t\t\t\t\t\t class=\"toolbar_icon smiley\" @tap=\"show_tool('smiley')\"></i>\n\t\t\t\t\t\t\t<button class=\"send_btn\" @tap=\"send_message(kefuMessage, 0)\" hover-class=\"send_btn_hover\" v-if=\"showSendButton\">发送</button>\n\t\t\t\t\t\t\t<i class=\"toolbar_icon attach\" :style=\"{background: 'url(' + attachBackground + ') no-repeat','background-size':'100% 100%'}\"\n\t\t\t\t\t\t\t @tap=\"show_tool('more')\" v-if=\"!showSendButton && attachBackground\"></i>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view v-if=\"showTool\" class=\"footer_div\">\n\t\t\t\t\t\t<!-- 表情 -->\n\t\t\t\t\t\t<block v-if=\"showTool == 'smiley'\" v-for=\"(item, index) in expressionData\" :key=\"index\">\n\t\t\t\t\t\t\t<image :src=\"item.src\" @tap=\"select_expression(item.title)\"></image>\n\t\t\t\t\t\t</block>\n\t\t\t\t\t\t<!-- 表情end -->\n\t\t\t\t\t\t<!-- 更多 -->\n\t\t\t\t\t\t<view v-if=\"showTool == 'more'\" class=\"toolbar\">\n\t\t\t\t\t\t\t<view @tap=\"show_select_model('order')\" v-if=\"config.toolbar && config.toolbar.order\" class=\"toolbar_item\">\n\t\t\t\t\t\t\t\t<image :src=\"config.toolbar.order.icon_image\"></image>\n\t\t\t\t\t\t\t\t<view>{{config.toolbar.order.title}}</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view @tap=\"show_select_model('goods')\" v-if=\"config.toolbar && config.toolbar.goods\" class=\"toolbar_item\">\n\t\t\t\t\t\t\t\t<image :src=\"config.toolbar.goods.icon_image\"></image>\n\t\t\t\t\t\t\t\t<view>{{config.toolbar.goods.title}}</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view @tap=\"upload_file\" v-if=\"config.toolbar && config.toolbar.file\" class=\"toolbar_item\">\n\t\t\t\t\t\t\t\t<image :src=\"config.toolbar.file.icon_image\"></image>\n\t\t\t\t\t\t\t\t<view>{{config.toolbar.file.title}}</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<!-- 更多end -->\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 订单和商品选择 -->\n\t\t\t\t<view v-if=\"selectModel\" class=\"select_model\">\n\t\t\t\t\t<view @tap=\"show_select_model(false)\" class=\"close_select\">关闭</view>\n\t\t\t\t\t<view class=\"project_list\">\n\t\t\t\t\t\t<radio-group v-if=\"selectModelData.length > 0\" @change=\"select_done\">\n\t\t\t\t\t\t\t<label v-for=\"(item, index) in selectModelData\" :key=\"index\" class=\"project_item\">\n\t\t\t\t\t\t\t\t<image :src=\"item.logo\"></image>\n\t\t\t\t\t\t\t\t<view class=\"project_item_body\">\n\t\t\t\t\t\t\t\t\t<view class=\"project_item_title\">{{item.subject}}</view>\n\t\t\t\t\t\t\t\t\t<view v-if=\"item.order_number\" class=\"project_item_note text-xs\">订单号:{{item.order_number}}</view>\n\t\t\t\t\t\t\t\t\t<!--<view v-if=\"item.note\" class=\"project_item_note\">{{item.note}}</view>-->\n\t\t\t\t\t\t\t\t\t<view class=\"project_item_price\">\n\t\t\t\t\t\t\t\t\t\t<text v-if=\"item.price\">￥{{item.price}}</text>\n\t\t\t\t\t\t\t\t\t\t<text v-if=\"item.number\">x{{item.number}}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<radio :value=\"index.toString()\" :checked=\"false\" />\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</radio-group>\n\t\t\t\t\t\t<view class=\"select_model_no_data\" v-if=\"selectModelData.length <= 0\"><text>没有更多记录了...</text></view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t</view>\n\t\t</view>\n</template>\n\n<script>\n\timport Vue from 'vue'\n\timport barTitle from '@/components/common/basics/bar-title';\n\timport Config from \"./config.js\"; // 本地配置数据\n\timport jyfParser from \"@/components/jyf-parser/jyf-parser\"; // 富文本解析\n\tvar token = ''; // 用户身份标识\n\tvar fixedCsr = ''; // 指定客服\n\tvar innerAudioContext = null;\n\texport default {\n\t\tcomponents: {\n\t\t\tjyfParser,\n\t\t\tbarTitle\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tleaveMessage: {\n\t\t\t\t\tname: '',\n\t\t\t\t\tcontact: '',\n\t\t\t\t\tmessage: ''\n\t\t\t\t},\n\t\t\t\tattachBackground: '',\n\t\t\t\tshowSendButton: false,\n\t\t\t\tshowTool: false,\n\t\t\t\tshowLeaveMessage: false,\n\t\t\t\texpressionData: [],\n\t\t\t\tconfig: [],\n\t\t\t\ttokenList: [],\n\t\t\t\tkefuMessage: '',\n\t\t\t\twrapperHeight: 46,\n\t\t\t\tws: {\n\t\t\t\t\tSocketTask: null,\n\t\t\t\t\tTimer: null, // 计时器\n\t\t\t\t\tErrorMsg: [], // 发送失败的消息\n\t\t\t\t\tMaxRetryCount: 3, // 最大重连次数\n\t\t\t\t\tCurrentRetryCount: 0,\n\t\t\t\t\tsocketOpen: false,\n\t\t\t\t\tpageHideCloseWs: true, // 是否在页面hide时关闭链接，兼容预览图片的情况\n\t\t\t\t\tunloadCloseWs: false // ws关闭状态码兼容性不好，手动标记页面卸载关闭ws链接\n\t\t\t\t},\n\t\t\t\tcsr: '', // 当前用户的客服代表ID\n\t\t\t\tsessionId: 0, // 会话ID\n\t\t\t\tsessionUser: \"\", // 带身份标识的用户ID\n\t\t\t\tkefuMessageFocus: false,\n\t\t\t\tmessageList: [],\n\t\t\t\tchatRecordPage: 1,\n\t\t\t\terrorTips: '链接中...',\n\t\t\t\tselectModel: false,\n\t\t\t\tselectModelData: [],\n\t\t\t\twriteBottom: 0,\n\t\t\t\tkefu_scroll_top: 0,\n\t\t\t\tkefu_scroll_with_animation: true,\n\t\t\t\trecord_scroll_height: 0,\n\t\t\t\tnavigation_bar_title: ''\n\t\t\t}\n\t\t},\n\t\tonLoad(opt) {\n\n\t\t\t// token = opt.token ? opt.token : token\n\t\t\tlet usertoken = Vue.prototype.$store.state.userInfo.token;\n\t\t\ttoken = usertoken;\n\t\t\tfixedCsr = opt.fixed_csr ? opt.fixed_csr : fixedCsr\n\n\t\t\t// 微信小程序端onshow时再链接，并在onhide时关闭链接\n\t\t\t// #ifndef MP-WEIXIN\n\t\t\tthis.load()\n\t\t\t// #endif\n\t\t},\n\t\tonShow() {\n\t\t\tif (!this.ws.pageHideCloseWs) {\n\t\t\t\tthis.ws.pageHideCloseWs = true;\n\t\t\t}\n\t\t\t// #ifdef MP-WEIXIN\n\t\t\tthis.load()\n\t\t\t// #endif\n\t\t},\n\t\tonHide() {\n\t\t\t// #ifdef MP-WEIXIN\n\t\t\tif (this.ws.SocketTask && this.ws.socketOpen && this.ws.pageHideCloseWs) {\n\t\t\t\tconsole.log('微信小程序页面hide主动关闭链接')\n\t\t\t\tuni.closeSocket();\n\t\t\t}\n\t\t\t// #endif\n\t\t},\n\t\tonUnload() {\n\t\t\tif (this.ws.SocketTask && this.ws.socketOpen) {\n\t\t\t\tconsole.log('页面卸载主动关闭链接')\n\t\t\t\tthis.ws.unloadCloseWs = true\n\t\t\t\tuni.closeSocket();\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tload: function() {\n\t\t\t\tvar that = this\n\t\t\t\tvar kefu_tourists_token = '';\n\n\t\t\t\t// 初始化请求\n\t\t\t\ttry {\n\t\t\t\t\tvar kefu_tourists_token = uni.getStorageSync('kefu_tourists_token');\n\t\t\t\t\tif (!kefu_tourists_token) {\n\t\t\t\t\t\tkefu_tourists_token = ''\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e)\n\t\t\t\t}\n\n\t\t\t\tuni.request({\n\t\t\t\t\turl: that.build_url('initialize'),\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttoken: token,\n\t\t\t\t\t\tkefu_tourists_token: kefu_tourists_token,\n\t\t\t\t\t\tfixed_csr: fixedCsr\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (res.data.code == 1) {\n\n\t\t\t\t\t\t\t// 保存游客token\n\t\t\t\t\t\t\tif (res.data.data.token_list.kefu_tourists_token) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tuni.setStorageSync('kefu_tourists_token', res.data.data.token_list.kefu_tourists_token);\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tconsole.error(e)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// 公告\n\t\t\t\t\t\t\tvar kefu_notice = ''\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tkefu_notice = uni.getStorageSync('kefu_notice');\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tconsole.log(e)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (kefu_notice == res.data.data.config.announcement) {\n\t\t\t\t\t\t\t\tres.data.data.config.announcement = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// 配置\n\t\t\t\t\t\t\tthat.config = res.data.data.config;\n\t\t\t\t\t\t\tthat.tokenList = res.data.data.token_list;\n\n\t\t\t\t\t\t\t// 来信提示音初始化\n\t\t\t\t\t\t\tinnerAudioContext = uni.createInnerAudioContext();\n\t\t\t\t\t\t\tinnerAudioContext.src = that.build_url('message_prompt');\n\n\t\t\t\t\t\t\t// 新消息提示\n\t\t\t\t\t\t\tif (res.data.data.new_msg) {\n\t\t\t\t\t\t\t\tthat.new_message_prompt()\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// 初始化表情\n\t\t\t\t\t\t\tvar protocol = Config.https_switch ? 'https://' : 'http://';\n\t\t\t\t\t\t\tvar expression = {};\n\t\t\t\t\t\t\tfor (let i in Config.expression) {\n\t\t\t\t\t\t\t\texpression[i] = {\n\t\t\t\t\t\t\t\t\t'src': protocol + Config.baseURL + '/assets/addons/kefu/img' + Config.expression[i].src,\n\t\t\t\t\t\t\t\t\t'title': Config.expression[i].title\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthat.expressionData = expression;\n\n\t\t\t\t\t\t\t// 杂项资源\n\t\t\t\t\t\t\tthat.attachBackground = that.build_url('res', '/img/more.png');\n\n\t\t\t\t\t\t\t// 链接ws\n\t\t\t\t\t\t\tthat.connect_socket();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\tcontent: res.data.msg,\n\t\t\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\t\t\tuni.navigateBack({\n\t\t\t\t\t\t\t\t\t\t\tdelta: 1\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: res => {\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\ttitle: '温馨提示',\n\t\t\t\t\t\t\tcontent: '在线客服初始化失败,请重试~',\n\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t})\n\t\t\t\t\t\tthat.errorTips = '初始化失败';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tswitch_show_tool: function(value) {\n\t\t\t\tif (!value) {\n\t\t\t\t\tthis.showTool = false;\n\t\t\t\t\tthis.writeBottom = 0;\n\t\t\t\t} else {\n\t\t\t\t\tthis.showTool = value;\n\t\t\t\t\tthis.writeBottom = 170;\n\t\t\t\t\tthis.scroll_into_footer();\n\t\t\t\t}\n\t\t\t},\n\t\t\tset_navigation_bar_title: function(title, back_title = true) {\n\t\t\t\tif (back_title) {\n\t\t\t\t\tthis.navigation_bar_title = title\n\t\t\t\t}\n\t\t\t\tuni.setNavigationBarTitle({\n\t\t\t\t\ttitle: title\n\t\t\t\t});\n\t\t\t},\n\t\t\tclose_notice: function() {\n\t\t\t\tuni.setStorageSync('kefu_notice', this.config.announcement);\n\t\t\t\tthis.config.announcement = '';\n\t\t\t},\n\t\t\tselect_done: function(e) {\n\t\t\t\tlet index = e.detail.value;\n\t\t\t\tvar message = '';\n\t\t\t\tfor (let i in this.selectModelData[index]) {\n\t\t\t\t\tmessage += i + '=' + this.selectModelData[index][i] + '#';\n\t\t\t\t}\n\t\t\t\tthis.send_message(message, (this.selectModel == 'goods') ? 4 : 5);\n\t\t\t\tthis.selectModel = false\n\t\t\t\tthis.switch_show_tool(false)\n\t\t\t},\n\t\t\tshow_select_model: function(name) {\n\t\t\t\tthis.selectModel = name\n\t\t\t\tif (!name) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '请稍后...'\n\t\t\t\t})\n\n\t\t\t\tvar data_api_url = this.config.toolbar[name].data_api\n\t\t\t\tvar reg = new RegExp(\"(^https?:\\/\\/)\", \"i\");\n\t\t\t\tif (data_api_url.search(reg) === -1) {\n\t\t\t\t\tdata_api_url = (Config.https_switch ? 'https://' : 'http://') + Config.baseURL + data_api_url\n\t\t\t\t}\n\n\t\t\t\tthis.selectModelData = [];\n\n\t\t\t\tuni.request({\n\t\t\t\t\turl: data_api_url,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttoken: token\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\tif (res.data.code == 1) {\n\t\t\t\t\t\t\tthis.selectModelData = res.data.data\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\ttitle: '温馨提示',\n\t\t\t\t\t\t\t\tcontent: res.data.msg,\n\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: res => {\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\ttitle: '温馨提示',\n\t\t\t\t\t\t\tcontent: '网络请求失败，请重试！',\n\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: res => {\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tparseUrl: function(data) {\n\t\t\t\tvar reg = new RegExp(\"(https?:\\/\\/)([0-9a-z.]+)([\\?0-9a-z&=]+)?(#[0-9-a-z]+)?\", \"g\");\n\t\t\t\treturn data.replace(reg, '<a target=\"_blank\" title=\"$&\" class=\"link\" href=\"$&\">$&</a>');\n\t\t\t},\n\t\t\tmessage_img_preview: function(e) {\n\t\t\t\tthis.ws.pageHideCloseWs = false; // 页面hide不关闭链接\n\t\t\t},\n\t\t\tpreview_img: function(src) {\n\t\t\t\tthis.ws.pageHideCloseWs = false; // 页面hide不关闭链接\n\t\t\t\tuni.previewImage({\n\t\t\t\t\tcurrent: src,\n\t\t\t\t\turls: [src]\n\t\t\t\t});\n\t\t\t},\n\t\t\tupload_file: function() {\n\t\t\t\tvar that = this\n\t\t\t\tthat.ws.pageHideCloseWs = false; // 页面hide不关闭链接\n\t\t\t\t\n\t\t\t\tthat.ws_send({\n\t\t\t\t\tc: 'Message',\n\t\t\t\t\ta: 'getUploadMultipart'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tuni.chooseImage({\n\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\tconst tempFilePaths = res.tempFilePaths;\n\n\t\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\t\ttitle: '正在上传...'\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tvar formData = new Object();\n\t\t\t\t\t\tif (that.config.upload.multipart) {\n\t\t\t\t\t\t\tfor (let i in that.config.upload.multipart) {\n\t\t\t\t\t\t\t\tformData[i] = that.config.upload.multipart[i]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst uploadTask = uni.uploadFile({\n\t\t\t\t\t\t\turl: that.build_url('upload'),\n\t\t\t\t\t\t\t// #ifdef APP-PLUS || H5\n\t\t\t\t\t\t\tfile: res.tempFiles[0],\n\t\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t\tfilePath: tempFilePaths[0],\n\t\t\t\t\t\t\tname: 'file',\n\t\t\t\t\t\t\tformData: formData,\n\t\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\t\t\tthat.ws.pageHideCloseWs = true;\n\t\t\t\t\t\t\t\tres = JSON.parse(res.data);\n\t\t\t\t\t\t\t\tif (res.code == 1) {\n\t\t\t\t\t\t\t\t\tthat.send_message(res.data.url, 1)\n\t\t\t\t\t\t\t\t\tthat.switch_show_tool(false)\n\t\t\t\t\t\t\t\t\tthat.kefuMessageFocus = true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\t\ttitle: '温馨提示',\n\t\t\t\t\t\t\t\t\t\tcontent: res.msg,\n\t\t\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcomplete: res => {\n\t\t\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// #ifndef APP-PLUS\n\t\t\t\t\t\tuploadTask.onProgressUpdate((res) => {\n\t\t\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\t\t\ttitle: res.progress + '%'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tconnect_socket: function() {\n\t\t\t\tvar that = this\n\n\t\t\t\tif (this.ws.SocketTask && this.ws.socketOpen) {\n\t\t\t\t\tconsole.log('无需链接')\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// 开始链接\n\t\t\t\tthat.ws.SocketTask = uni.connectSocket({\n\t\t\t\t\turl: this.build_url('ws'),\n\t\t\t\t\theader: {\n\t\t\t\t\t\t'content-type': 'application/json'\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: res => {}\n\t\t\t\t});\n\n\t\t\t\t// 链接打开\n\t\t\t\tuni.onSocketOpen(function(res) {\n\t\t\t\t\tconsole.log('链接已打开')\n\t\t\t\t\tthat.ws.socketOpen = true\n\t\t\t\t\tthat.ws.CurrentRetryCount = 0;\n\t\t\t\t\t// 重新发送所有出错的消息\n\t\t\t\t\tfor (let i in that.ws.ErrorMsg) {\n\t\t\t\t\t\tthat.ws_send(that.ws.ErrorMsg[i]);\n\t\t\t\t\t}\n\t\t\t\t\tthat.ws.ErrorMsg = [];\n\t\t\t\t\tthat.errorTips = '';\n\n\t\t\t\t\tif (that.ws.Timer != null) {\n\t\t\t\t\t\tclearInterval(that.ws.Timer);\n\t\t\t\t\t}\n\n\t\t\t\t\tthat.ws.Timer = setInterval(that.ws_send, 28000); //定时发送心跳\n\t\t\t\t});\n\n\t\t\t\t// 收到消息\n\t\t\t\tuni.onSocketMessage(function(res) {\n\t\t\t\t\tlet msg = JSON.parse(res.data)\n\t\t\t\t\tlet actions = that.domsg()\n\t\t\t\t\tlet action = actions[msg.msgtype] || actions['default']\n\t\t\t\t\taction.call(this, msg)\n\t\t\t\t})\n\n\t\t\t\t// 出错\n\t\t\t\tuni.onSocketError(function(res) {\n\t\t\t\t\tthat.ws.socketOpen = false;\n\t\t\t\t\tthat.errorTips = 'WebSocket 发生错误!'\n\t\t\t\t\tconsole.log('链接出错', res)\n\t\t\t\t});\n\n\t\t\t\t// 链接关闭\n\t\t\t\tuni.onSocketClose(function(res) {\n\t\t\t\t\t// 工具上是1000，真机上测试是10000\n\t\t\t\t\tconsole.log('链接已关闭', res)\n\t\t\t\t\tthat.ws.socketOpen = false;\n\n\t\t\t\t\tif (that.ws.Timer != null) {\n\t\t\t\t\t\tclearInterval(that.ws.Timer);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (that.errorTips.indexOf('重连') === -1) {\n\t\t\t\t\t\tthat.errorTips = '网络链接已断开!';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (res.code == 1000 || res.code == 10000 || that.ws.unloadCloseWs) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (that.ws.MaxRetryCount) {\n\t\t\t\t\t\tthat.ws.Timer = setInterval(that.retry_websocket, 3000); //每3秒重新连接一次\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t// 重连ws\n\t\t\tretry_websocket: function() {\n\t\t\t\tvar that = this\n\t\t\t\tif (that.ws.CurrentRetryCount < that.ws.MaxRetryCount) {\n\t\t\t\t\tthat.ws.CurrentRetryCount++;\n\t\t\t\t\tthat.connect_socket();\n\t\t\t\t\tthat.errorTips = '重连WebSocket第' + that.ws.CurrentRetryCount + '次';\n\t\t\t\t} else {\n\t\t\t\t\tif (that.ws.Timer != null) {\n\t\t\t\t\t\tclearInterval(that.ws.Timer);\n\t\t\t\t\t}\n\n\t\t\t\t\tthat.errorTips = '每隔10秒将再次尝试重连 WebSocket';\n\t\t\t\t\tthat.ws.Timer = setInterval(that.connect_socket, 10000); //每10秒重新连接一次\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 发送ws消息\n\t\t\tws_send: function(message) {\n\t\t\t\tvar that = this\n\t\t\t\tif (!message) {\n\t\t\t\t\tmessage = {\n\t\t\t\t\t\tc: 'Message',\n\t\t\t\t\t\ta: 'ping'\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (that.ws.SocketTask && that.ws.socketOpen) {\n\t\t\t\t\tuni.sendSocketMessage({\n\t\t\t\t\t\tdata: JSON.stringify(message)\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('消息发送出错', message, that.ws.SocketTask, that.ws.socketOpen)\n\t\t\t\t\tthat.ws.ErrorMsg.push(message);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsend_message: function(message, message_type) {\n\t\t\t\tvar that = this\n\t\t\t\t\n\t\t\t\tconsole.log(that.sessionId);\n\t\t\t\tif (message == '') {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '请输入消息内容',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// 检查 websocket 是否连接\n\t\t\t\tif (!that.ws.SocketTask || !that.ws.socketOpen) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '网络链接异常，请稍后重试~',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!that.sessionId) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '初始化未完成(会话获取失败)~',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (message_type == 0) {\n\n\t\t\t\t\t// 处理链接\n\t\t\t\t\tmessage = that.parseUrl(message);\n\n\t\t\t\t\t// 处理表情\n\t\t\t\t\tvar reg = /\\[(.+?)\\]/g; // [] 中括号\n\t\t\t\t\tvar reg_match = message.match(reg);\n\n\t\t\t\t\tif (reg_match) {\n\n\t\t\t\t\t\tfor (let i in reg_match) {\n\t\t\t\t\t\t\tvar emoji_item = that.find_emoji(reg_match[i]);\n\t\t\t\t\t\t\tmessage = message.replace(emoji_item.title, that.build_chat_img(emoji_item.src, '', 'emoji'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tlet message_data = that.messageList[that.messageList.length - 1].data;\n\t\t\t\tvar message_id = parseInt(message_data[message_data.length - 1].id) + 1;\n\t\t\t\t// var message_id = new Date().getTime() + that.sessionId + Math.floor(Math.random() * 10000);\n\t\t\t\tvar load_message = {\n\t\t\t\t\tc: 'Message',\n\t\t\t\t\ta: 'sendMessage',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessage: message,\n\t\t\t\t\t\tmessage_type: message_type,\n\t\t\t\t\t\tsession_id: that.sessionId,\n\t\t\t\t\t\tmodulename: 'index',\n\t\t\t\t\t\tmessage_id: message_id\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthat.ws_send(load_message);\n\n\t\t\t\tvar data = {\n\t\t\t\t\tid: message_id,\n\t\t\t\t\tstatus: 2, // 标记待发送状态\n\t\t\t\t\tsender: 'me',\n\t\t\t\t\tmessage: (message_type == 1 || message_type == 2) ? that.config.upload.cdnurl + message : message,\n\t\t\t\t\tmessage_type: message_type\n\t\t\t\t}\n\n\t\t\t\tvar messageListIndex = that.messageList.length - 1\n\t\t\t\tif (that.messageList[messageListIndex] && that.messageList[messageListIndex].datetime == '刚刚') {\n\t\t\t\t\tthat.messageList[messageListIndex].data = that.messageList[messageListIndex].data.concat(that.format_message([\n\t\t\t\t\t\tdata\n\t\t\t\t\t]))\n\t\t\t\t} else {\n\t\t\t\t\tthat.messageList = that.messageList.concat({\n\t\t\t\t\t\tdatetime: '刚刚',\n\t\t\t\t\t\tdata: that.format_message([data])\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthat.kefuMessage = ''\n\t\t\t\tthat.kefu_message_change();\n\t\t\t\tthat.scroll_into_footer(200, 99992)\n\t\t\t},\n\t\t\tfind_emoji: function(emoji_title) {\n\t\t\t\tfor (let i in this.expressionData) {\n\t\t\t\t\tif (this.expressionData[i].title == emoji_title) {\n\t\t\t\t\t\treturn this.expressionData[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tbuild_chat_img: function(filename, facename, class_name = 'emoji') {\n\t\t\t\tvar protocol = Config.https_switch ? 'https://' : 'http://';\n\t\t\t\tif (class_name == 'emoji') {\n\t\t\t\t\treturn '<img class=\"emoji\" src=\"' + filename + '\" />';\n\t\t\t\t} else {\n\t\t\t\t\treturn '<img class=\"' + class_name + '\" src=\"' + filename + '\" />';\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 记录用户填写的留言数据，方便后续清空输入等处理\n\t\t\tleave_message: function(e) {\n\t\t\t\tif (e.currentTarget.id == 'c-name') {\n\t\t\t\t\tthis.leaveMessage.name = e.detail.value\n\t\t\t\t} else if (e.currentTarget.id == 'c-contact') {\n\t\t\t\t\tthis.leaveMessage.contact = e.detail.value\n\t\t\t\t} else if (e.currentTarget.id == 'c-message') {\n\t\t\t\t\tthis.leaveMessage.message = e.detail.value\n\t\t\t\t}\n\t\t\t},\n\t\t\tpost_leave_message: function() {\n\t\t\t\tif (!this.leaveMessage.contact) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '联系方式不能为空哦~',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tvar leave_message = {\n\t\t\t\t\tc: 'Message',\n\t\t\t\t\ta: 'leaveMessage',\n\t\t\t\t\tdata: this.leaveMessage\n\t\t\t\t};\n\t\t\t\tthis.ws_send(leave_message);\n\t\t\t},\n\t\t\tdomsg: function(msg) {\n\t\t\t\tvar that = this\n\t\t\t\treturn {\n\t\t\t\t\tdefault: (msg) => {\n\t\t\t\t\t\t// console.log('default', msg);\n\t\t\t\t\t},\n\t\t\t\t\tinitialize: (msg) => {\n\t\t\t\t\t\tif (msg.data.new_msg) {\n\t\t\t\t\t\t\tthat.new_message_prompt()\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// 分配/获取客服->获取聊天记录\n\t\t\t\t\t\tvar user_initialize = {\n\t\t\t\t\t\t\tc: 'Message',\n\t\t\t\t\t\t\ta: 'userInitialize',\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tfixed_csr: that.fixedCsr\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthat.ws_send(user_initialize);\n\t\t\t\t\t},\n\t\t\t\t\tuser_initialize: (msg) => {\n\t\t\t\t\t\t// 用户客服分配结束\n\t\t\t\t\t\tif (msg.code == 1) {\n\n\t\t\t\t\t\t\tif (msg.data.session.user_tourists) {\n\t\t\t\t\t\t\t\tthat.send_message = function() {\n\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\ttitle: '为保护您的隐私请,请登录后发送消息~',\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthat.csr = msg.data.session.csr;\n\t\t\t\t\t\t\tthat.sessionId = msg.data.session.id;\n\t\t\t\t\t\t\tthat.showLeaveMessage = false\n\t\t\t\t\t\t\tthat.set_navigation_bar_title('客服 ' + msg.data.session.nickname + ' 为您服务')\n\t\t\t\t\t\t} else if (msg.code == 302) {\n\n\t\t\t\t\t\t\tif (!that.csr) {\n\n\t\t\t\t\t\t\t\t// 打开留言板\n\t\t\t\t\t\t\t\tthat.csr = 'none';\n\t\t\t\t\t\t\t\tthat.showLeaveMessage = true\n\t\t\t\t\t\t\t\tthat.set_navigation_bar_title('当前无客服在线哦~')\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '当前客服暂时离开,您可以直接发送离线消息~',\n\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tshow_msg: (msg) => {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: msg.msg,\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tleave_message: (msg) => {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: msg.msg,\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tthat.leaveMessage = {\n\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\tcontact: '',\n\t\t\t\t\t\t\tmessage: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tclear: (msg) => {\n\t\t\t\t\t\tif (msg.msg) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: msg.msg,\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar clear = {\n\t\t\t\t\t\t\tc: 'Message',\n\t\t\t\t\t\t\ta: 'clear'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthat.ws_send(clear);\n\n\t\t\t\t\t\tthat.ws.unloadCloseWs = true;\n\t\t\t\t\t},\n\t\t\t\t\toffline: (msg) => {\n\t\t\t\t\t\tif (msg.user_id == that.csr) {\n\t\t\t\t\t\t\tthis.errorTips = '客服离线~'\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonline: (msg) => {\n\t\t\t\t\t\t// 来自 admin 的用户上线\n\t\t\t\t\t\tif (msg.modulename == 'admin') {\n\n\t\t\t\t\t\t\tif (msg.user_id == that.csr) {\n\t\t\t\t\t\t\t\tthat.errorTips = '';\n\t\t\t\t\t\t\t} else if (that.csr == 'none') {\n\t\t\t\t\t\t\t\t// 重新为用户分配客服代表\n\t\t\t\t\t\t\t\tvar user_initialize = {\n\t\t\t\t\t\t\t\t\tc: 'Message',\n\t\t\t\t\t\t\t\t\ta: 'userInitialize'\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tthat.ws_send(user_initialize);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcsr_change_status: (msg) => {\n\t\t\t\t\t\tif (that.csr == msg.data.csr) {\n\t\t\t\t\t\t\tif (msg.data.csr_status != 3) {\n\t\t\t\t\t\t\t\tthat.errorTips = '客服' + that.get_csr_status(msg.data.csr_status) + '~'\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthat.errorTips = '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttransfer_done: (msg) => {\n\t\t\t\t\t\tthat.csr = msg.data.csr;\n\t\t\t\t\t\tthat.set_navigation_bar_title('客服 ' + msg.data.nickname + ' 为您服务')\n\t\t\t\t\t},\n\t\t\t\t\tnew_message: (msg) => {\n\t\t\t\t\t\tthat.new_message_prompt();\n\n\t\t\t\t\t\tif (msg.data.session_id == that.sessionId) {\n\n\t\t\t\t\t\t\tthat.set_navigation_bar_title(that.navigation_bar_title, false)\n\n\t\t\t\t\t\t\tvar messageListIndex = that.messageList.length - 1\n\t\t\t\t\t\t\tmsg.data.id = msg.data.record_id\n\t\t\t\t\t\t\tif (that.messageList[messageListIndex].datetime == '刚刚') {\n\t\t\t\t\t\t\t\tthat.messageList[messageListIndex].data = that.messageList[messageListIndex].data.concat(that.format_message(\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tmsg.data\n\t\t\t\t\t\t\t\t\t]))\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthat.messageList = that.messageList.concat({\n\t\t\t\t\t\t\t\t\tdatetime: '刚刚',\n\t\t\t\t\t\t\t\t\tdata: that.format_message([msg.data])\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar load_message = {\n\t\t\t\t\t\t\t\tc: 'Message',\n\t\t\t\t\t\t\t\ta: 'readMessage',\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\trecord_id: msg.data.record_id,\n\t\t\t\t\t\t\t\t\tsession_id: that.sessionId\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tthat.ws_send(load_message);\n\n\t\t\t\t\t\t\tthat.scroll_into_footer(800);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tchat_record: (msg) => {\n\t\t\t\t\t\t// 下一页\n\t\t\t\t\t\tthat.chatRecordPage = msg.data.next_page;\n\t\t\t\t\t\tfor (let i in msg.data.chat_record) {\n\t\t\t\t\t\t\tmsg.data.chat_record[i].data = that.format_message(msg.data.chat_record[i].data)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (msg.data.page == 1) {\n\t\t\t\t\t\t\tthat.messageList = msg.data.chat_record;\n\t\t\t\t\t\t\t// 滑动到最后一条消息\n\t\t\t\t\t\t\tthat.scroll_into_footer(200, 99991);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (let i = msg.data.chat_record.length - 1; i >= 0; i--) {\n\t\t\t\t\t\t\t\tmsg.data.chat_record[i].data.reverse()\n\t\t\t\t\t\t\t\tthat.messageList.unshift(msg.data.chat_record[i]);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tlet kefu_scroll = uni.createSelectorQuery().select('#kefu_scroll');\n\t\t\t\t\t\t\t\tkefu_scroll.fields({\n\t\t\t\t\t\t\t\t\tscrollOffset: true\n\t\t\t\t\t\t\t\t}, data => {\n\t\t\t\t\t\t\t\t\tthat.kefu_scroll_top = data.scrollHeight - that.record_scroll_height\n\t\t\t\t\t\t\t\t\tthat.kefu_scroll_with_animation = true\n\t\t\t\t\t\t\t\t}).exec()\n\t\t\t\t\t\t\t}, 200)\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tsend_message: (msg) => {\n\t\t\t\t\t\tif (!msg.data.message_id) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar messageListIndex = that.messageList.length - 1\n\t\t\t\t\t\tfor (let i in that.messageList[messageListIndex].data) {\n\t\t\t\t\t\t\tif (that.messageList[messageListIndex].data[i].id == msg.data.message_id) {\n\t\t\t\t\t\t\t\tthat.messageList[messageListIndex].data[i].status = (msg.code == 1) ? 0 : 3;\n\t\t\t\t\t\t\t\tthat.messageList[messageListIndex].data[i].id = msg.data.id\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (msg.code == 0) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: msg.data.msg,\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tread_message_done: (msg) => {\n\t\t\t\t\t\tif (that.sessionId == msg.data.session_id) {\n\t\t\t\t\t\t\tif (msg.data.record_id == 'all') {\n\t\t\t\t\t\t\t\tfor (let messageListIndex in that.messageList) {\n\t\t\t\t\t\t\t\t\tfor (let i in that.messageList[messageListIndex].data) {\n\t\t\t\t\t\t\t\t\t\tthat.messageList[messageListIndex].data[i].status = 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfor (let messageListIndex in that.messageList) {\n\t\t\t\t\t\t\t\t\tfor (let i in that.messageList[messageListIndex].data) {\n\t\t\t\t\t\t\t\t\t\tif (that.messageList[messageListIndex].data[i].id == msg.data.record_id) {\n\t\t\t\t\t\t\t\t\t\t\tthat.messageList[messageListIndex].data[i].status = 1;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmessage_input: (msg) => {\n\t\t\t\t\t\tvar that = this\n\t\t\t\t\t\tvar input_status_display = parseInt(that.config.input_status_display);\n\t\t\t\t\t\tif (input_status_display == 0 || input_status_display == 2) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (msg.data.type == 'input') {\n\t\t\t\t\t\t\tthat.set_navigation_bar_title('客服正在输入...', false)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthat.set_navigation_bar_title(that.navigation_bar_title, false)\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tupload_multipart: (msg) => {\n\t\t\t\t\t\tif (msg.data.upload_multipart) {\n\t\t\t\t\t\t\tthat.config.upload.multipart = msg.data.upload_multipart\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tget_csr_status: function(status_id) {\n\n\t\t\t\tconst states = {\n\t\t\t\t\t0: '离线',\n\t\t\t\t\t1: '繁忙',\n\t\t\t\t\t2: '离开',\n\t\t\t\t\t3: '在线',\n\t\t\t\t\t99: '断链',\n\t\t\t\t\t'default': '未知'\n\t\t\t\t}\n\n\t\t\t\treturn states[parseInt(status_id)] || states['default'];\n\t\t\t},\n\t\t\tbuild_url: function(type = 'ws', res_path) {\n\t\t\t\tvar that = this\n\t\t\t\tvar protocol = Config.https_switch ? 'https://' : 'http://';\n\t\t\t\tvar token = that.tokenList.kefu_token ? '&token=' + that.tokenList.kefu_token : '';\n\t\t\t\tvar kefu_tourists_token = that.tokenList.kefu_tourists_token ? '&kefu_tourists_token=' + that.tokenList.kefu_tourists_token :\n\t\t\t\t\t'';\n\n\t\t\t\tvar buildObj = {\n\t\t\t\t\tws: () => {\n\t\t\t\t\t\tprotocol = parseInt(that.config.wss_switch) == 1 ? 'wss://' : 'ws://';\n\t\t\t\t\t\treturn (protocol + Config.baseURL + ':' + that.config.websocket_port + '/?modulename=index' + token +\n\t\t\t\t\t\t\tkefu_tourists_token).replace(\n\t\t\t\t\t\t\t/\\|/g, '~');\n\t\t\t\t\t},\n\t\t\t\t\tinitialize: () => {\n\t\t\t\t\t\treturn protocol + Config.baseURL + '/addons/kefu/index/initialize?modulename=index';\n\t\t\t\t\t},\n\t\t\t\t\tupload: () => {\n\t\t\t\t\t\treturn that.config.upload.uploadurl + '?modulename=index' + token + kefu_tourists_token;\n\t\t\t\t\t},\n\t\t\t\t\tstorage_notify: () => {\n\t\t\t\t\t\t// 云存储notify，未实现，能获取的文件信息太少。\n\t\t\t\t\t\treturn protocol + Config.baseURL + '/addons/' + type + '/index/notify';\n\t\t\t\t\t},\n\t\t\t\t\tmessage_prompt: () => {\n\t\t\t\t\t\tif (that.config.upload.cdnurl) {\n\t\t\t\t\t\t\treturn that.config.upload.cdnurl + that.config.ringing;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn protocol + Config.baseURL + that.config.ringing;\n\t\t\t\t\t},\n\t\t\t\t\tres: () => {\n\t\t\t\t\t\tif (that.config.__CDN__) {\n\t\t\t\t\t\t\treturn that.config.__CDN__ + '/assets/addons/kefu' + res_path;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn protocol + Config.baseURL + '/assets/addons/kefu' + res_path;\n\t\t\t\t\t},\n\t\t\t\t\tdefault: () => {\n\t\t\t\t\t\treturn protocol + Config.baseURL;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tlet action = buildObj[type] || buildObj['default']\n\t\t\t\treturn action.call(this)\n\t\t\t},\n\t\t\tnew_message_prompt: function() {\n\t\t\t\tif (innerAudioContext) {\n\t\t\t\t\tinnerAudioContext.play();\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tinnerAudioContext.stop();\n\t\t\t\t\t}, 1000)\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error('来信提示音播放失败！');\n\t\t\t\t}\n\t\t\t},\n\t\t\tscroll_into_footer: function(timeout = 0, kefu_scroll_top = 0) {\n\t\t\t\tvar that = this\n\t\t\t\tif (kefu_scroll_top) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tthat.kefu_scroll_top = (that.kefu_scroll_top > 99990) ? that.kefu_scroll_top + 200 : kefu_scroll_top\n\t\t\t\t\t}, timeout)\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet kefu_scroll = uni.createSelectorQuery().select('#kefu_scroll');\n\t\t\t\tkefu_scroll.fields({\n\t\t\t\t\tscrollOffset: true\n\t\t\t\t}, data => {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tthat.kefu_scroll_top = data.scrollHeight\n\t\t\t\t\t}, timeout)\n\t\t\t\t}).exec()\n\t\t\t},\n\t\t\twrapper_scrolltoupper: function() {\n\t\t\t\tvar that = this\n\t\t\t\tif (!this.sessionId || this.chatRecordPage == 'done') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// 加载历史聊天记录\n\t\t\t\tvar load_message = {\n\t\t\t\t\tc: 'Message',\n\t\t\t\t\ta: 'chatRecord',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tsession_id: this.sessionId,\n\t\t\t\t\t\tpage: this.chatRecordPage\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthat.kefu_scroll_with_animation = false\n\t\t\t\tlet kefu_scroll = uni.createSelectorQuery().select('#kefu_scroll');\n\t\t\t\tkefu_scroll.fields({\n\t\t\t\t\tscrollOffset: true\n\t\t\t\t}, data => {\n\t\t\t\t\tthat.record_scroll_height = data.scrollHeight\n\t\t\t\t}).exec()\n\n\t\t\t\tthis.ws_send(load_message);\n\t\t\t},\n\t\t\ttap_scroll_view: function() {\n\t\t\t\tthis.switch_show_tool(false)\n\t\t\t},\n\t\t\tshow_tool: function(name = 'smiley') {\n\n\t\t\t\tthis.switch_show_tool((this.showTool == name) ? false : name)\n\n\t\t\t\tif (this.showTool) {\n\t\t\t\t\tthis.scroll_into_footer()\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 输入框聚焦\n\t\t\ttextarea_focus: function(e) {\n\t\t\t\tvar that = this\n\t\t\t\tthis.showTool = false;\n\t\t\t\tthat.scroll_into_footer(0, 99993)\n\t\t\t\tthat.writeBottom = e.detail.height ? e.detail.height : 0;\n\t\t\t},\n\t\t\t// 输入框输入\n\t\t\ttextarea_input: function(e) {\n\t\t\t\tvar that = this\n\t\t\t\tthat.kefuMessage = e.detail.value\n\t\t\t\tthat.kefu_message_change()\n\n\t\t\t\tif (parseInt(that.config.input_status_display) == 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar kefu_message_input = {\n\t\t\t\t\tc: 'Message',\n\t\t\t\t\ta: 'messageInput',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tsession_id: that.sessionId,\n\t\t\t\t\t\tsession_user: that.csr || that.sessionUser,\n\t\t\t\t\t\ttype: 'input'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthat.ws_send(kefu_message_input);\n\t\t\t},\n\t\t\t// 显示/隐藏发送按钮-调整消息记录框高度\n\t\t\tkefu_message_change: function() {\n\t\t\t\tthis.showSendButton = (this.kefuMessage == '') ? false : true;\n\t\t\t\tlet write = uni.createSelectorQuery().select('.write');\n\t\t\t\twrite.fields({\n\t\t\t\t\tsize: true\n\t\t\t\t}, data => {\n\t\t\t\t\tif (data.height != this.wrapperHeight) {\n\t\t\t\t\t\tthis.wrapperHeight = data.height\n\t\t\t\t\t}\n\t\t\t\t}).exec()\n\t\t\t},\n\t\t\t// 消息框焦点\n\t\t\tkefu_message_blur: function() {\n\t\t\t\tvar that = this\n\t\t\t\tthat.kefuMessageFocus = false;\n\t\t\t\tif (!that.showTool) {\n\t\t\t\t\tthat.writeBottom = 0;\n\t\t\t\t}\n\n\t\t\t\tif (parseInt(that.config.input_status_display) == 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar kefu_message_input = {\n\t\t\t\t\tc: 'Message',\n\t\t\t\t\ta: 'messageInput',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tsession_id: that.sessionId,\n\t\t\t\t\t\tsession_user: that.csr || that.sessionUser,\n\t\t\t\t\t\ttype: 'blur'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthat.ws_send(kefu_message_input);\n\t\t\t},\n\t\t\tselect_expression: function(title) {\n\t\t\t\tthis.kefuMessage = this.kefuMessage + title;\n\t\t\t\tthis.kefu_message_change();\n\t\t\t},\n\t\t\tformat_message: function(message) {\n\t\t\t\tfor (let i in message) {\n\t\t\t\t\tif (message[i].message_type == 4 || message[i].message_type == 5) {\n\t\t\t\t\t\tvar message_arr = message[i].message.split('#');\n\t\t\t\t\t\tvar message_obj = {};\n\n\t\t\t\t\t\tfor (let y in message_arr) {\n\t\t\t\t\t\t\tlet message_temp = message_arr[y].split('=');\n\t\t\t\t\t\t\tif (typeof message_temp[1] != 'undefined') {\n\t\t\t\t\t\t\t\tmessage_obj[message_temp[0]] = message_temp[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmessage[i].message = message_obj;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn message;\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t* {\n\t\tpadding: 0;\n\t\tmargin: 0;\n\t}\n\n\tpage {\n\t\toverflow: hidden;\n\t}\n\n\t.kefu_container {\n\t\theight: calc(100vh - var(--window-top));\n\t\toverflow: hidden;\n\t\tbackground-color: #F8F8F8;\n\t}\n\n\t.error_tips {\n\t\tposition: fixed;\n\t\ttop: var(--window-top);\n\t\twidth: 100%;\n\t\theight: 80rpx;\n\t\tfont-size: 30rpx;\n\t\tline-height: 80rpx;\n\t\tbackground: rgba(231, 76, 60, 0.7);\n\t\tz-index: 999;\n\t\tcolor: #FFFFFF;\n\t\ttext-align: center;\n\t}\n\n\t.notice {\n\t\tposition: fixed;\n\t\ttop: var(--window-top);\n\t\twidth: 100%;\n\t\tfont-size: 30rpx;\n\t\tline-height: 36rpx;\n\t\tpadding: 16rpx;\n\t\tbox-sizing: border-box;\n\t\tbackground: rgba(252, 248, 227, 1);\n\t\tcolor: #c09853;\n\t\tz-index: 999;\n\t}\n\n\t.close_notice {\n\t\tcolor: #999;\n\t\tfont-size: 26rpx;\n\t\ttext-decoration: underline;\n\t}\n\n\t.select_model {\n\t\tbackground-color: #f2f2f2;\n\t\tposition: fixed;\n\t\tbottom: 0rpx;\n\t\tz-index: 998;\n\t\twidth: 100%;\n\t\tborder-top-left-radius: 32rpx;\n\t\tborder-top-right-radius: 32rpx;\n\t}\n\n\t.close_select {\n\t\tbox-sizing: border-box;\n\t\tfont-size: 28rpx;\n\t\tpadding: 16rpx 22rpx;\n\t\tcolor: #999;\n\t\twidth: 100%;\n\t\ttext-align: right;\n\t}\n\n\t.project_list {\n\t\toverflow-y: auto;\n\t\toverflow-x: hidden;\n\t\theight: 362rpx;\n\t}\n\n\t.project_item {\n\t\tbackground-color: #FFFFFF;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 16rpx 8rpx 16rpx 16rpx;\n\t\tmargin-bottom: 16rpx;\n\t}\n\t\n\t.bubble .project_item {\n\t\tmargin-bottom: 0rpx;\n\t}\n\n\t.project_item:last-child {\n\t\tmargin-bottom: 0;\n\t}\n\n\t.project_item image {\n\t\twidth: 140rpx;\n\t\theight: 140rpx;\n\t\tmin-width: 140rpx;\n\t}\n\n\t.project_item_body {\n\t\theight: 130rpx;\n\t\twidth: 96%;\n\t\tmargin: 0 16rpx;\n\t}\n\n\t.project_item_title {\n\t\tfont-size: 26rpx;\n\t\tdisplay: block;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\tdisplay: -webkit-box;\n\t\t-webkit-box-orient: vertical;\n\t\t-webkit-line-clamp: 2;\n\t\t/*line-height: 30rpx;\n\t\theight: 60rpx;*/\n\t\tcolor: #181818;\n\t}\n\n\t.project_item_note {\n\t\tfont-size: 26rpx;\n\t\tdisplay: block;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t\tline-height: 30rpx;\n\t\tcolor: #999999;\n\t\tmargin-top: 4rpx;\n\t}\n\n\t.project_item_price text:last-child {\n\t\tmargin-left: 16rpx;\n\t\tcolor: #999999;\n\t\tfont-size: 24rpx;\n\t}\n\n\t.project_item_price text:first-child {\n\t\tmargin-left: -6rpx;\n\t\tfont-size: 30rpx;\n\t\tcolor: rgba(231, 76, 60, 1);\n\t}\n\n\t.select_model_no_data {\n\t\tfont-size: 30rpx;\n\t\theight: 100%;\n\t\tbackground: #FFFFFF;\n\t\tcolor: #999999;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.content_wrapper {}\n\n\t.chat_wrapper {\n\t\tbackground-color: #F8F8F8;\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t\tcolor: #181818;\n\t}\n\n\t.chat_wrapper scroll-view {\n\t\theight: 100%;\n\t}\n\n\t.chat_wrapper .status {\n\t\tposition: relative;\n\t\tfloat: right;\n\t\twidth: 100%;\n\t\tmargin-bottom: 20rpx;\n\t\ttext-align: center;\n\t\theight: 60rpx;\n\t\tline-height: 60rpx;\n\t}\n\n\t.chat_wrapper .status text {\n\t\tfont-size: 24rpx;\n\t\tdisplay: inline-block;\n\t\tbackground: #ccc;\n\t\tcolor: #fff;\n\t\tborder-radius: 10rpx;\n\t\tpadding: 6rpx 20rpx;\n\t\tline-height: 24rpx;\n\t}\n\n\t.chat_wrapper .bubble {\n\t\tfont-size: 32rpx;\n\t\tposition: relative;\n\t\tdisplay: inline-block;\n\t\tclear: both;\n\t\tmargin-bottom: 16rpx;\n\t\tpadding: 24rpx 24rpx;\n\t\tvertical-align: top;\n\t\tborder-radius: 10rpx;\n\t\tmax-width: 76%;\n\t}\n\n\t.chat_wrapper .bubble.me .kefu_message_status {\n\t\tposition: absolute;\n\t\tbottom: 0;\n\t\tleft: -30px;\n\t\tcolor: #00b0ff;\n\t\tfont-size: 12px;\n\t}\n\n\t.chat_wrapper .kf-text-grey {\n\t\tcolor: #999 !important;\n\t}\n\n\t.chat_wrapper .kf-text-red {\n\t\tcolor: #e64340 !important;\n\t}\n\n\t.chat_wrapper .bubble.me {\n\t\tfloat: right;\n\t\tmargin-right: 28rpx;\n\t\tmargin-left: 20rpx;\n\t\tcolor: #fff;\n\t\tbackground-color: #00b0ff;\n\t\tword-wrap: break-word;\n\t\tword-break: break-all;\n\t}\n\n\t.chat_wrapper .bubble.you {\n\t\tfloat: left;\n\t\tmargin-right: 20rpx;\n\t\tmargin-left: 28rpx;\n\t\tcolor: #181818;\n\t\tbackground-color: #fff;\n\t\tword-wrap: break-word;\n\t\tword-break: break-all;\n\t}\n\n\t.chat_wrapper .bubble:before {\n\t\tposition: absolute;\n\t\ttop: 38rpx;\n\t\tdisplay: block;\n\t\twidth: 16rpx;\n\t\theight: 12rpx;\n\t\tcontent: '\\00a0';\n\t\t-webkit-transform: rotate(29deg) skew(-35deg);\n\t\ttransform: rotate(29deg) skew(-35deg);\n\t}\n\n\t.chat_wrapper .bubble.you:before {\n\t\tleft: -6rpx;\n\t\tbackground-color: #fff;\n\t}\n\n\t.chat_wrapper .bubble.me:before {\n\t\tright: -6rpx;\n\t\tbackground-color: #00b0ff;\n\t}\n\n\t.chat_wrapper .bubble image {\n\t\tmax-height: 400rpx !important;\n\t\twidth: 200rpx;\n\t\tvertical-align: bottom;\n\t}\n\n\t.chat_wrapper .bubble .emoji {\n\t\tdisplay: inline-block;\n\t\twidth: 120rpx;\n\t\theight: 120rpx;\n\t}\n\n\t.content_wrapper .write {\n\t\tbox-sizing: border-box;\n\t\tbackground-color: #f7f7f7;\n\t\tbox-shadow: 0 -2rpx 0 #e5e5e5;\n\t\twidth: 100%;\n\t\tpadding: 8rpx 12rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tposition: fixed;\n\t\tbottom: 0rpx;\n\t}\n\n\t.write_right {\n\t\tflex: 2;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.widget_textarea {\n\t\tflex: 8;\n\t\tbackground-color: #FFFFFF;\n\t}\n\n\t.content_wrapper .toolbar_icon {\n\t\tdisplay: inline-block;\n\t\tcursor: pointer;\n\t\tvertical-align: middle;\n\t\twidth: 56rpx;\n\t\theight: 56rpx;\n\t\tcontent: '';\n\t\tmargin-left: 16rpx;\n\t}\n\n\t.kefu_message {\n\t\tmax-height: 150rpx;\n\t\twidth: calc(100% - 36rpx);\n\t\toutline: none;\n\t\tborder: none;\n\t\tresize: none;\n\t\tborder-radius: 8rpx;\n\t\tpadding: 18rpx;\n\t\t-webkit-user-select: text !important;\n\t\t-moz-user-select: text !important;\n\t\t-ms-user-select: text !important;\n\t\tuser-select: text !important;\n\t\tline-height: 40rpx;\n\t\tfont-size: 32rpx;\n\t\tcolor: #181818;\n\t}\n\n\t.kefu_message::-webkit-scrollbar {\n\t\twidth: 4rpx;\n\t}\n\n\t.kefu_message::-webkit-scrollbar-track {\n\t\tbackground-color: #fff;\n\t\t-webkit-border-radius: 2em;\n\t\t-moz-border-radius: 2em;\n\t\tborder-radius: 2em;\n\t}\n\n\t.kefu_message::-webkit-scrollbar-thumb {\n\t\tbackground-color: #e6e6e6;\n\t\t-webkit-border-radius: 2em;\n\t\t-moz-border-radius: 2em;\n\t\tborder-radius: 2em;\n\t}\n\n\t.footer_div {\n\t\tposition: fixed;\n\t\tbottom: 0rpx;\n\t\tbackground-color: #fff;\n\t\tbox-shadow: 0 8rpx 10rpx rgba(0, 0, 0, .1);\n\t\twidth: 100%;\n\t\tanimation: show_footer_div .1s;\n\t\tanimation-fill-mode: forwards;\n\t\tpadding-top: 12rpx;\n\t\tbox-sizing: border-box;\n\t\theight: 170px;\n\t\toverflow-y: auto;\n\t\toverflow-x: hidden;\n\t}\n\n\t@keyframes show_footer_div {\n\t\tfrom {\n\t\t\theight: 0;\n\t\t}\n\n\t\tto {\n\t\t\theight: 170px;\n\t\t}\n\t}\n\n\t.footer_div image {\n\t\theight: 51rpx;\n\t\twidth: 51rpx;\n\t\tpadding: 12rpx;\n\t}\n\n\t.send_btn {\n\t\tmargin-left: 28rpx;\n\t\tbackground: #00b0ff;\n\t\tcolor: #fff;\n\t\tborder-color: #00b0ff;\n\t\toutline: none;\n\t\tpadding: 10rpx 20rpx;\n\t\tfont-size: 24rpx;\n\t\tline-height: 1.5;\n\t\tborder-radius: 6rpx;\n\t}\n\n\t.send_btn::after {\n\t\tborder: none;\n\t}\n\n\t.send_btn_hover {\n\t\tbackground-color: #19baff;\n\t}\n\n\t.toolbar {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t}\n\n\t.toolbar_item {\n\t\tmargin-top: 20rpx;\n\t\twidth: 25%;\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.toolbar_item image {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t}\n\n\t.toolbar_item view {\n\t\tdisplay: block;\n\t\twidth: 100%;\n\t\tfont-size: 26rpx;\n\t\tline-height: 34rpx;\n\t\ttext-align: center;\n\t}\n\n\t.leave_message {\n\t\twidth: 90%;\n\t\tdisplay: block;\n\t\tmargin: 40rpx auto;\n\t\tfont-size: 32rpx;\n\t}\n\n\t.form-control {\n\t\tmargin: 20rpx 0;\n\t\twidth: 90%;\n\t\tdisplay: block;\n\t\tpadding: 12rpx 24rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #555;\n\t\tbackground-color: #fff;\n\t\tbackground-image: none;\n\t\tborder: 1px solid #ccc;\n\t\tborder-radius: 8rpx;\n\t\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);\n\t\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);\n\t\t-webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;\n\t\t-o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;\n\t\ttransition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;\n\t}\n\n\t.leave_success {\n\t\tcolor: #fff;\n\t\tbackground: #5cb85c;\n\t\tborder-color: #4cae4c;\n\t\tmargin: 0 auto;\n\t\tdisplay: inline-block;\n\t\tpadding: 12rpx 24rpx;\n\t\tmargin-bottom: 0;\n\t\tfont-size: 28rpx;\n\t\tfont-weight: 400;\n\t\tline-height: 1.42;\n\t\ttext-align: center;\n\t\twhite-space: nowrap;\n\t\tcursor: pointer;\n\t\tborder: 1px solid transparent;\n\t\tborder-radius: 8rpx;\n\t}\n</style>","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1676796533234\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}